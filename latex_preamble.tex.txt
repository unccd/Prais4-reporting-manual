\setcounter{secnumdepth}{-1} % Remove chapter numbering
\setcounter{tocdepth}{1} % Set depth of table of contents

\usepackage[nofonts]{ctex}
% \usepackage[UTF8]{ctex}
\usepackage{caption}
\usepackage{lscape}
\usepackage{array}
\usepackage[none]{hyphenat}
\usepackage[document]{ragged2e}
\usepackage{polyglossia}
\usepackage{xurl} % Improves line breaking of long URLs
\usepackage{fancyhdr} % see https://texblog.org/2007/11/07/headerfooter-in-latex-with-fancyhdr/
\usepackage{titlesec}
\usepackage{titletoc}
\usepackage{etoolbox} % for patching commands
\usepackage{unicode-math}
\usepackage{sectsty}
% \usepackage[
%     a4paper,
%     top=2cm,
%     bottom=2cm,
%     left=1cm,
%     right=1cm,
%     headheight=12pt,
%     footskip=1cm
% ]{geometry}

% --- Attempts to improve font rendering ---
% \usepackage[defaultsans]{lato}
% \defaultfontfeatures[FandolSong]{Script=Default}
% --- Set local font path ---
% Since Sphinx copies the font files directly into the _build/latex/ directory,
% the path for fontspec should be '.' (current directory) or left empty.
% \defaultfontfeatures{Path=./, Extension={.ttf}}
%

\defaultfontfeatures{Extension=.ttf}
\setmainfont{NotoSans}[UprightFont=*-Regular, ItalicFont=*-Italic, BoldFont=*-Bold, BoldItalicFont = *-BoldItalic]
\setsansfont{NotoSans}[UprightFont=*-Regular, ItalicFont=*-Italic, BoldFont=*-Bold, BoldItalicFont = *-BoldItalic]
\setmonofont{NotoSansMono}[UprightFont=*-Regular, BoldFont=*-Bold]

\setmathfont{NotoSansMath}[UprightFont=*]

% \setCJKmainfont{NotoSansSC}[Script=CJK, UprightFont=*-Regular, BoldFont=*-Bold]


% --- Main document font (Latin, Cyrillic, etc.) ---
\setmainfont{NotoSans}[UprightFont=*-Regular, ItalicFont=*-Italic, BoldFont=*-Bold, BoldItalicFont = *-BoldItalic]
\setsansfont{NotoSans}[UprightFont=*-Regular, ItalicFont=*-Italic, BoldFont=*-Bold, BoldItalicFont = *-BoldItalic]
\setmonofont{NotoSansMono}[UprightFont=*-Regular, BoldFont=*-Bold]
\newfontfamily{\notocondensedfont}{NotoSansCondensed}[Scale=0.8, UprightFont=*-Regular, ItalicFont=*-Italic, BoldFont=*-Bold, BoldItalicFont = *-SemiBoldItalic]

% Use condensed font for Latin tables
\renewcommand{\sphinxstyletheadfamily}{\notocondensedfont\bfseries}
% \protected\def\sphinxstyletheadfamily {\notocondensedfont}
\BeforeBeginEnvironment{tabular}{\notocondensedfont}
\AfterEndEnvironment{tabular}{\normalfont}
\BeforeBeginEnvironment{tabulary}{\notocondensedfont}
\AfterEndEnvironment{tabulary}{\normalfont}
\BeforeBeginEnvironment{longtable}{\notocondensedfont}
\AfterEndEnvironment{longtable}{\normalfont}


\captionsetup{labelformat=empty} % Remove automatic figure/table numbers
\captionsetup[table]{position=below} % Tables captions below the table

% \usepackage{colortbl}
% \protected\def\sphinxstylethead {\cellcolor{green}\textsf}
% \renewcommand{\rowcolors}{} % Disable alternating row colors in tables
% \definecolor{sphinxheadercolor}{rgb}{1,1,1} % White

% \newcommand{\sphinxtitle}{} % Declare the command
% \AtBeginDocument{\renewcommand{\sphinxtitle}{PRAIS4 Reporting Manual}}


\titleformat{\chapter}[display] % format of chapter titles
% [display] means the title will be set in a block, taking up the full width of the text
{\bfseries\fontsize{16}{14}\bfseries\color{black}} % font formatting
{\chaptertitlename\ \thechapter} % Pre-title (like "Chapter 1"), appears before the actual title text
% Our chapters are not numbered because of secnumdepth
{16pt}  % vertical space between the "pre-title" and the actual chapter title
{\MakeUppercase}

\titleformat{\section}[display] % format of section titles
{\bfseries\fontsize{14}{12}\bfseries\color{black}}
{\sectiontitlename\ \thesection}
{14pt}{}

\titleformat{\subsection}[display]
{\bfseries\fontsize{12}{10}\bfseries\color{black}}
{\sectiontitlename\ \thesection}
{12pt}{}

\titleformat{\subsubsection}[display]
{\normalfont\fontsize{12}{10}\normalfont\color{black}}
{\sectiontitlename\ \thesection}
{11pt}{}

\sphinxsetup{%
    InnerLinkColor={rgb}{0,0,0},
    OuterLinkColor={rgb}{0,0.4,0.72}
}
% --- Fancy Header/Footer ---
\fancyhf{}  % Clear default headers/footers
\fancypagestyle{plain}{ % first page of a chapter and special pages
\fancyhf{} % Clear headers/footers for plain style
\fancyfoot[R]{\footnotesize\thepage}
% No lines for plain style
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}
}
\fancypagestyle{normal}{
    \fancyhf{}
    % \fancyhead[L]{\chaptertitlename\ \thechapter} % chapter number
    % \fancyhead[R]{\rightmark} % section name
    \fancyhead[L]{\footnotesize\rightmark} % chapter name
    \fancyfoot[R]{\footnotesize\thepage} % Page numbers
    \renewcommand{\headrulewidth}{0.4pt}
    \renewcommand{\footrulewidth}{0.4pt}
}
